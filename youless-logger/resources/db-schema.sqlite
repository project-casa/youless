CREATE TABLE devices(
    id INTEGER PRIMARY KEY,
    ip CHAR(15) NOT NULL UNIQUE,
    name VARCHAR NOT NULL UNIQUE,
    created_at DATETIME NOT NULL,
    updated_at DATETIME
);

CREATE TABLE categories(
    id INTEGER PRIMARY KEY,
    device_id VARCHAR NOT NULL,
    type VARCHAR(5) NOT NULL,
    name VARCHAR,
    created_at DATETIME NOT NULL,
    updated_at DATETIME,
    UNIQUE(device_id, type)
);

CREATE TABLE intervals(
    id INTEGER PRIMARY KEY,
    name VARCHAR(5) NOT NULL UNIQUE
);

CREATE TABLE units(
    id INTEGER PRIMARY KEY,
    name VARCHAR(5) NOT NULL UNIQUE
);

CREATE TABLE data(
   timestamp INT NOT NULL,
   category_id INT NOT NULL,
   interval_id INT(1) NOT NULL,
   value INT NOT NULL,
   unit_id INT(1) NOT NULL,
   PRIMARY KEY(timestamp, category_id, interval_id)
) WITHOUT ROWID;

INSERT INTO intervals VALUES
    ( 1, 'min' ),
    ( 2, '10min' ),
    ( 3, 'hour' ),
    ( 4, 'day' );

INSERT INTO units VALUES
    ( 1, 'watt' ),
    ( 2, 'kwh' ),
    ( 3, 'liter' ),
    ( 4, 'm3' );
